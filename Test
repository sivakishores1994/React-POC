import React from "react";
import { render } from "@testing-library/react";
import { Provider } from "react-redux";
import configureStore from "redux-mock-store";
import Header from "./Header";
import { getUrl } from "../../../utils/common/change.utils";

// Mocking dependencies
jest.mock("../../../utils/common/change.utils", () => ({
  getUrl: {
    getParameterByName: jest.fn(),
  },
}));

jest.mock("../../../utils/store/store", () => ({
  store: {
    getState: jest.fn(() => ({
      stages: { isDocumentUpload: false, stages: [{ stageId: "testStage", stageInfo: { application: { journey_type: "ETC" }, products: [{ name: "Product Name", product_category: "CC", product_type: "280" }] } }] },
    })),
  },
}));

jest.mock("../../../utils/common/header-titles", () =>
  jest.fn(() => "Mocked Header Title")
);

jest.mock("../../../shared/components/close/close", () => () => (
  <div data-testid="close-button">Close Button</div>
));

jest.mock("../../../shared/components/logo/logo", () => () => (
  <div data-testid="logo">Logo</div>
));

const mockStore = configureStore([]);

describe("Header Component", () => {
  let store: any;

  beforeEach(() => {
    store = mockStore({
      stages: {
        stages: [
          {
            stageId: "testStage",
            stageInfo: {
              application: { journey_type: "ETC" },
              products: [
                {
                  name: "Product Name",
                  product_category: "CC",
                  product_type: "280",
                },
              ],
            },
          },
        ],
        journeyType: "ETC",
      },
    });

    (getUrl.getParameterByName as jest.Mock).mockReturnValue(null);
  });

  it("renders without crashing", () => {
    const { getByText } = render(
      <Provider store={store}>
        <Header />
      </Provider>
    );

    expect(getByText("Mocked Header Title")).toBeInTheDocument();
  });

  // Additional tests...
});
